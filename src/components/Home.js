// import { useNavigate } from 'react-router-dom';
// import Network from '../utils/Network';
// import React, { useState, useEffect } from 'react';
// import jwtDecode from 'jwt-decode';
// function Home() {
//   const [error, setError] = useState(null);
//   const [errorMsg, setErrorMsg] = useState(null);
//   const [sessionLoading, setSessionLoading] = useState(true);
//   const [name, setName] = useState(null);
//   const [email, setEmail] = useState(null);
//   const [group, setGroup] = useState(null);
//   const [user, setUser] = useState(null);
//   const navigate = useNavigate();

//   if (!localStorage.getItem('jwt')) navigate('/');
//   const token = localStorage.getItem('jwt');
//   const decodedToken = jwtDecode(token);
//   const id = decodedToken.id;
//   console.log('token deco home.js 19  :', decodedToken);
//   const API = new Network();
//   async function getUser(id) {
//     try {
//       const data = await API.get(`/users/user?id=${id}`);

//       setName(data.data.name);
//       setEmail(data.data.email);
//       setGroup(data.data.group.name);
//       setUser(data.data);
//     } catch (e) {
//       console.log(e);
//     }
//   }

//   useEffect(() => {
//     getUser(id);
//   }, []);

//   return (
//     <div>
//       <h1 className="text-amber-700">Home bonjour {name}</h1>
//       <p className="text-amber-700">email: {email}</p>
//       <p>group: {group}</p>
//     </div>
//   );
// }
// export default Home;

// Dans le Login stocker dans le contexte le payload du jwt
// Dans pog ma hom récupérer le user depuis le contexte
// recuperer son groupId
// filtrer le tableau de resultat en f(x) de l'id du groupe de l'utilisateur
import { useNavigate } from 'react-router-dom';
import Network from '../utils/Network';
import React, { useState, useEffect } from 'react';
import jwtDecode from 'jwt-decode';

function Home() {
  const [error, setError] = useState(null);
  const [user, setUser] = useState(null);
  const navigate = useNavigate();
  const API = new Network();

  useEffect(() => {
    if (!localStorage.getItem('jwt')) navigate('/');

    const token = localStorage.getItem('jwt');
    const decodedToken = jwtDecode(token);
    const id = decodedToken.id;

    async function getUser(id) {
      try {
        const data = await API.get(`/users/user?id=${id}`);
        setUser(data.data);
      } catch (e) {
        console.log(e);
      }
    }

    getUser(id);
  }, [navigate]);

  return (
    <div className="p-4">
      <h1 className="text-2xl font-bold mb-4">Welcome, {user?.name}</h1>
      <p className="mb-2">Email: {user?.email}</p>
      <p>Group: {user?.group?.name}</p>
    </div>
  );
}

export default Home;
